{% extends "base.html" %}

{% block title %}Service status â€“ Transport for Portsmouth{% endblock %}

{% block content %}


<style>
  .all-good-banner {
    margin-top: 24px;
    padding: 14px 28px;

    background-color: #0019A8; /* TfL blue */
    color: #ffffff;

    height: 150px;

    font-size: 1rem;
    font-weight: 600;

    border-radius: 6px;

    display: flex;
    align-items: center;
    gap: 10px;
  }

  .all-good-banner::before {
    content: "";
    font-size: 1.1rem;
    line-height: 1;
  }

</style>

<h1>Service status</h1>

{% with has_issues=False %}

{% for mode in modes %}
  <section class="status-mode">
    <h2>{{ mode.name }}</h2>

    {% regroup routes by operator as operator_groups %}

    {% for group in operator_groups %}
      {% for route in group.list %}
        {% if route.mode == mode %}
          {% with status=route.active_statuses.0 %}
            {% if status %}
              {% with has_issues=True %}
                <ul class="status-route-list">
                  <li class="status-route">
                    {% with bar_colour=route.route_hex|default:route.operator.primary_hex %}
                      <span
                        class="status-bar"
                        style="background-color: {{ bar_colour }}"
                        aria-hidden="true"
                      ></span>
                    {% endwith %}

                    <span class="route-name">{{ route.service }}</span>

                    <span class="route-status">
                      {{ status.status_type.name }}
                    </span>
                  </li>
                </ul>
              {% endwith %}
            {% endif %}
          {% endwith %}
        {% endif %}
      {% endfor %}
    {% endfor %}
  </section>
{% endfor %}

{% if not has_issues %}
  <div class="all-good-banner">
    Good service on all other lines
  </div>
{% endif %}

{% endwith %}
{% endblock %}
